(this["webpackJsonpfinal-comp426"]=this["webpackJsonpfinal-comp426"]||[]).push([[0],{33:function(e,t,s){},51:function(e,t,s){},77:function(e,t,s){"use strict";s.r(t);var a=s(2),n=s.n(a),r=s(44),i=s.n(r),c=s(20),o=s(5),l=(s(51),s(6)),u=s.n(l),h=s(19),p=s(28),d=s(10),b=s(11),j=s(13),m=s(12),v=(s(33),s(25));s(53),s(78);v.a.initializeApp({apiKey:"AIzaSyB-DMBKi2_wbv0hjXobVt1QWLaSKwZ6kJc",authDomain:"final-comp426.firebaseapp.com",projectId:"final-comp426",storageBucket:"final-comp426.appspot.com",messagingSenderId:"24353847634",appId:"1:24353847634:web:de8214c3a05ca07843e28b",measurementId:"G-QMTKDZKGPX"});var f=v.a.auth(),x=v.a.firestore(),O=s(1);function g(e){return Object(O.jsx)(y,{img:"".concat("/final-comp426","/bullet.png"),width:"4px",height:"16px",left:e.x,top:e.y})}function y(e){return Object(O.jsx)("img",{src:e.img,width:e.width,height:e.height,style:{left:e.left,top:e.top}})}var k=function(e){Object(j.a)(s,e);var t=Object(m.a)(s);function s(e){var a;return Object(d.a)(this,s),(a=t.call(this,e)).processKey=function(e){switch(e.key){case"ArrowLeft":a.movingLeft=10,a.movingRight=0;break;case"ArrowRight":a.movingRight=10,a.movingLeft=0;break;case" ":a.shoot()}},a.shoot=function(){var e=a.state.bullets;e.push({x:a.state.x+a.props.dimension/2,y:a.props.y-16}),a.setState({x:a.state.x,y:a.state.y,bullets:e}),a.props.onUpdateBullets(e)},a.movingLeft=0,a.movingRight=0,a.state={x:e.x,y:e.y,bullets:[]},a}return Object(b.a)(s,[{key:"componentDidMount",value:function(){var e=this;this.keyEventListener=window.addEventListener("keydown",this.processKey),this.updateInterval=setInterval((function(){e.update()}),50)}},{key:"componentWillUnmount",value:function(){this.pauseGame()}},{key:"pauseGame",value:function(){window.removeEventListener("keydown",this.processKey),clearInterval(this.updateInterval)}},{key:"update",value:function(){this.movePlayer(),this.moveBullets()}},{key:"movePlayer",value:function(){this.movingLeft?(this.state.x>5?this.setState({x:this.state.x-5}):this.setState({x:0}),this.movingLeft-=1):this.movingRight&&(this.state.x<this.props.game_dimension-this.props.dimension-5?this.setState({x:this.state.x+5}):this.setState({x:this.props.game_dimension-this.props.dimension}),this.movingRight-=1),this.props.onUpdate(this.state.x,this.state.y)}},{key:"moveBullets",value:function(){for(var e=this.state.bullets,t=e.length-1;t>=0;t--)e[t].y-=20,e[t].y<0&&e.splice(t,1);this.setState({x:this.state.x,y:this.state.y,bullets:e}),this.props.onUpdateBullets(e)}},{key:"render",value:function(){var e=this.state.bullets.map((function(e,t){return Object(O.jsx)("div",{children:Object(O.jsx)(g,{x:e.x,y:e.y})},t)}));return Object(O.jsxs)("div",{children:[Object(O.jsx)(y,{img:"".concat("/final-comp426","/invader.png"),width:this.props.dimension+"px",height:this.props.dimension+"px",left:this.state.x,top:this.props.y}),e]})}}]),s}(n.a.Component),w=s(46),S=35,_=function(e){Object(j.a)(s,e);var t=Object(m.a)(s);function s(e){var a;return Object(d.a)(this,s),(a=t.call(this,e)).state={aliens:a.props.aliens,bullets:a.props.bullets},a}return Object(b.a)(s,[{key:"componentDidMount",value:function(){var e=this;this.updateInterval=setInterval((function(){e.update()}),100),this.newBulletInterval=setInterval((function(){e.setState({bullets:e.newBullet()})}),1e3)}},{key:"componentWillUnmount",value:function(){this.pauseGame()}},{key:"pauseGame",value:function(){clearInterval(this.updateInterval),clearInterval(this.newBulletInterval)}},{key:"update",value:function(){var e=this.moveAliens(),t=Object(w.a)(e,3),s=t[0],a=t[1],n=t[2];this.setState({bullets:this.updateBullets()}),this.props.onUpdate(s,a,this.props.aliens,n)}},{key:"moveAliens",value:function(){var e=this.props.x,t=this.props.y,s=this.props.movingRight;return s?(e+=5)==this.props.dimension-10-S*this.props.cols&&(t+=10,s=!1):10==(e-=5)&&(t+=10,s=!0),[e,t,s]}},{key:"updateBullets",value:function(){for(var e=this.state.bullets,t=e.length-1;t>=0;t--)e[t].y+=15,e[t].y>=this.props.dimension&&e.splice(t,1);return this.props.onUpdateBullets(e),e}},{key:"newBullet",value:function(){var e=this.state.bullets,t=this.getBottomAliens(),s=Math.floor(Math.random()*t.length);return e.push({x:this.props.x+t[s].col*S+17.5,y:this.props.y+t[s].row*S+S}),this.props.onUpdateBullets(e),e}},{key:"getBottomAliens",value:function(){for(var e=[],t=0;t<this.props.cols;t++){for(var s=this.props.rows-1;s>=0&&!this.props.aliens[s][t];)s-=1;-1!=s&&e.push({row:s,col:t})}return e}},{key:"render",value:function(){for(var e=[],t=0;t<this.props.aliens.length;t++)for(var s=0;s<this.props.aliens[0].length;s++)this.props.aliens[t][s]&&e.push({x:this.props.x+s*S,y:this.props.y+t*S});var a=e.map((function(e,t){return Object(O.jsx)("div",{children:Object(O.jsx)(C,{x:e.x,y:e.y})},t)})),n=this.state.bullets.map((function(e,t){return Object(O.jsx)("div",{children:Object(O.jsx)(I,{x:e.x,y:e.y})},t)}));return Object(O.jsxs)("div",{children:[a,n]})}}]),s}(n.a.Component),C=function(e){Object(j.a)(s,e);var t=Object(m.a)(s);function s(e){return Object(d.a)(this,s),t.call(this,e)}return Object(b.a)(s,[{key:"render",value:function(){return Object(O.jsx)(A,{img:"".concat("/final-comp426","/alien.png"),width:"35px",height:"35px",left:this.props.x,top:this.props.y})}}]),s}(n.a.Component),I=function(e){Object(j.a)(s,e);var t=Object(m.a)(s);function s(e){return Object(d.a)(this,s),t.call(this,e)}return Object(b.a)(s,[{key:"render",value:function(){return Object(O.jsx)(A,{img:"".concat("/final-comp426","/bullet2.png"),width:"2px",height:"15px",left:this.props.x,top:this.props.y})}}]),s}(n.a.Component);function A(e){return Object(O.jsx)("img",{src:e.img,width:e.width,height:e.height,style:{left:e.left,top:e.top}})}var B=_,E=s(30),L=s.n(E),U=41.25,M=35,N=function(e){Object(j.a)(s,e);var t=Object(m.a)(s);function s(){var e;return Object(d.a)(this,s),(e=t.call(this)).startGame=function(){e.setState({gameStart:!0})},e.player_x=null,e.player_y=null,e.state={alien_x:10,alien_y:10,movingRight:!0,alien_bullets:[],player_bullets:[],player_lives:3,aliens:e.createAlienCrowd(),score:0,gameOver:!1,gameStart:!1},e}return Object(b.a)(s,[{key:"updatePlayer",value:function(e,t){this.player_x=e,this.player_y=t}},{key:"updateAliens",value:function(e,t,s,a){this.setState({aliens:s,alien_x:e,alien_y:t,movingRight:a}),this.hitPlayer()&&this.setState({gameOver:!0})}},{key:"updateAlienBullets",value:function(e){this.setState({alien_bullets:e}),this.checkForCollision()}},{key:"updatePlayerBullets",value:function(e){this.setState({player_bullets:e}),this.checkForShot()}},{key:"hitPlayer",value:function(){if(this.collision(this.player_x,this.player_y,U,U,this.state.alien_x,this.state.alien_y,385,175))for(var e=this.state.aliens.length-1;e>=0;e--)for(var t=0;t<this.state.aliens[0].length;t++)if(this.state.aliens[e][t]&&this.collision(this.player_x,this.player_y,U,U,this.state.alien_x+t*M,this.state.alien_y+e*M,M,M))return!0;return!1}},{key:"checkForCollision",value:function(){for(var e=this.state.alien_bullets,t=this.state.player_lives,s=this.state.gameOver,a=e.length-1;a>=0;a--){var n=e[a];this.collision(n.x,n.y,2,15,this.player_x,this.player_y,U,U)&&(e.splice(a,1),0==(t-=1)&&(s=!0,this.updateFirebase(this.state.score)))}this.setState({alien_bullets:e,player_lives:t,gameOver:s})}},{key:"updateFirebase",value:function(){var e=Object(h.a)(u.a.mark((function e(t){var s,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=f.currentUser,e.prev=1,e.next=4,x.collection("users").doc(s.uid).get();case 4:if(a=e.sent,!(t>a.data().high_score)){e.next=13;break}return e.prev=6,e.next=9,x.collection("users").doc(s.uid).set({high_score:t,username:a.data().username});case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(6);case 13:e.next=17;break;case 15:e.prev=15,e.t1=e.catch(1);case 17:case"end":return e.stop()}}),e,null,[[1,15],[6,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"checkForShot",value:function(){for(var e=this.state.player_bullets,t=this.state.aliens,s=this.state.score,a=e.length-1;a>=0;a--){var n=e[a];if(this.collision(n.x,n.y,4,16,this.state.alien_x,this.state.alien_y,385,175))for(var r=!1,i=t.length-1;i>=0;i--){for(var c=0;c<t[0].length;c++)if(!r&&t[i][c]&&this.collision(n.x,n.y,4,16,this.state.alien_x+c*M,this.state.alien_y+i*M,M,M)){r=!0,e.splice(a,1),t[i][c]=0,s+=10;break}if(r)break}}this.allEmpty(t)?(t=this.createAlienCrowd(),this.setState({alien_x:10,alien_y:10,aliens:t,score:s,alien_bullets:e,movingRight:!0})):this.setState({aliens:t,score:s,alien_bullets:e})}},{key:"allEmpty",value:function(e){for(var t=0;t<e.length;t++)for(var s=0;s<e[0].length;s++)if(e[t][s])return!1;return!0}},{key:"createAlienCrowd",value:function(){for(var e=[],t=0;t<5;t++){for(var s=[],a=0;a<11;a++)s.push(1);e.push(s)}return e}},{key:"collision",value:function(e,t,s,a,n,r,i,c){return e<n+i&&e+s>n&&t<r+c&&t+a>r}},{key:"render",value:function(){var e=this;return this.state.gameOver?Object(O.jsx)("div",{className:"Game",children:Object(O.jsx)(G,{score:this.state.score})}):this.state.gameStart?Object(O.jsxs)("div",{className:"Game",children:[Object(O.jsx)(k,{onUpdate:function(t,s){e.updatePlayer(t,s)},onUpdateBullets:function(t){e.updatePlayerBullets(t)},x:this.props.dimension/2-20.625,y:.85*this.props.dimension,dimension:U,game_dimension:this.props.dimension}),Object(O.jsx)(B,{onUpdate:function(t,s,a,n){e.updateAliens(t,s,a,n)},onUpdateBullets:function(t){e.updateAlienBullets(t)},x:this.state.alien_x,y:this.state.alien_y,rows:5,cols:11,dimension:this.props.dimension,bullets:this.state.alien_bullets,aliens:this.state.aliens,movingRight:this.state.movingRight}),Object(O.jsx)("div",{className:"Lives",children:Object(O.jsxs)("p",{children:["LIVES: ",this.state.player_lives]})}),Object(O.jsx)("div",{className:"Score",children:Object(O.jsxs)("p",{children:["SCORE: ",this.state.score]})})]}):Object(O.jsx)("div",{className:"Game",children:Object(O.jsx)("p",{onClick:this.startGame,className:"StartGame",children:"CLICK TO START"})})}}]),s}(n.a.Component),G=function(e){Object(j.a)(s,e);var t=Object(m.a)(s);function s(e){var a;return Object(d.a)(this,s),(a=t.call(this,e)).handleTweet=Object(h.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L()({method:"post",url:"https://comp426-1fa20.cs.unc.edu/a09/tweets",withCredentials:!0,data:{body:"Just scored ".concat(a.props.score," points in Space Invaders!")}});case 2:e.sent;case 3:case"end":return e.stop()}}),e)}))),a.reloadGame=function(){window.location.reload(!1)},a.getJoke=Object(h.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L()({method:"get",url:"https://icanhazdadjoke.com/",headers:{Accept:"text/plain"}});case 2:t=e.sent,a.setState({joke:t.data});case 4:case"end":return e.stop()}}),e)}))),a.state={joke:""},a.getJoke(),a}return Object(b.a)(s,[{key:"render",value:function(){return Object(O.jsxs)("div",{className:"GameOver",children:[Object(O.jsx)("h3",{children:"GAME OVER"}),Object(O.jsxs)("p",{children:["Score: ",this.props.score]}),Object(O.jsx)("a",{onClick:this.reloadGame,children:"PLAY AGAIN"}),Object(O.jsx)("a",{onClick:this.handleTweet,children:"TWEET"}),Object(O.jsxs)("p",{children:["Here's a joke to cheer you up! ",Object(O.jsx)("br",{})," ",this.state.joke]})]})}}]),s}(n.a.Component),P=N,R=function(e){Object(j.a)(s,e);var t=Object(m.a)(s);function s(){var e;return Object(d.a)(this,s),(e=t.call(this)).state={loggedIn:!1},e}return Object(b.a)(s,[{key:"componentDidMount",value:function(){var e=this;f.onAuthStateChanged((function(t){t&&e.setState({loggedIn:!0})}))}},{key:"render",value:function(){return this.state.loggedIn?Object(O.jsx)(o.a,{to:"/play"}):Object(O.jsxs)("div",{className:"Home",children:[Object(O.jsx)("h1",{children:"SPACE INVADERS"}),Object(O.jsxs)("h4",{children:[Object(O.jsx)(c.b,{to:"/login",children:"LOGIN"})," or ",Object(O.jsx)(c.b,{to:"/signup",children:"SIGN UP"})," to play"]})]})}}]),s}(n.a.Component),H=function(e){Object(j.a)(s,e);var t=Object(m.a)(s);function s(){var e;return Object(d.a)(this,s),(e=t.call(this)).formChangeHandler=function(t){var s=t.target.name,a=t.target.value;e.setState(Object(p.a)({},s,a))},e.submitFormHandler=function(){var t=Object(h.a)(u.a.mark((function t(s){var a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s.preventDefault(),""!=e.state.email&&""!=e.state.password){t.next=4;break}return e.setState({errorMessage:"Must enter email/password"}),t.abrupt("return");case 4:return t.prev=4,t.next=7,f.signInWithEmailAndPassword(e.state.email,e.state.password);case 7:a=t.sent,a.user,e.setState({signedIn:!0}),t.next=26;break;case 12:t.prev=12,t.t0=t.catch(4),n="",t.t1=t.t0.code,t.next="auth/invalid-email"===t.t1?18:"auth/user-not-found"===t.t1?20:"auth/wrong-password"===t.t1?22:24;break;case 18:return n="Invalid Email",t.abrupt("break",25);case 20:return n="Email not registered",t.abrupt("break",25);case 22:return n="Wrong password",t.abrupt("break",25);case 24:return t.abrupt("break",25);case 25:e.setState({errorMessage:n});case 26:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}(),e.state={email:"",password:"",signedIn:!1,errorMessage:""},e}return Object(b.a)(s,[{key:"render",value:function(){return this.state.signedIn?Object(O.jsx)(o.a,{to:"/play"}):Object(O.jsxs)("div",{class:"Login",children:[Object(O.jsx)("h2",{children:"LOGIN"}),Object(O.jsxs)("form",{onSubmit:this.submitFormHandler,children:[Object(O.jsx)("input",{type:"text",name:"email",placeholder:"Email",onChange:this.formChangeHandler}),Object(O.jsx)("input",{type:"password",name:"password",placeholder:"Password",onChange:this.formChangeHandler}),Object(O.jsx)("p",{class:"errorMessage",children:this.state.errorMessage}),Object(O.jsxs)("div",{children:[Object(O.jsx)("a",{onClick:this.submitFormHandler,children:"SUBMIT"}),Object(O.jsx)("h6",{children:Object(O.jsx)(c.b,{to:"/",children:"CANCEL"})})]})]})]})}}]),s}(n.a.Component),T=function(e){Object(j.a)(s,e);var t=Object(m.a)(s);function s(){var e;return Object(d.a)(this,s),(e=t.call(this)).formChangeHandler=function(t){var s=t.target.name,a=t.target.value;e.setState(Object(p.a)({},s,a))},e.submitFormHandler=function(){var t=Object(h.a)(u.a.mark((function t(s){var a,n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s.preventDefault(),""!=e.state.email&&""!=e.state.password&&""!=e.state.username){t.next=4;break}return e.setState({errorMessage:"Must enter username/email/password"}),t.abrupt("return");case 4:return t.prev=4,t.next=7,f.createUserWithEmailAndPassword(e.state.email,e.state.password);case 7:a=t.sent,n=a.user,e.addUser(n),e.setState({signedIn:!0}),t.next=27;break;case 13:t.prev=13,t.t0=t.catch(4),r="",t.t1=t.t0.code,t.next="auth/email-already-in-use"===t.t1?19:"auth/invalid-email"===t.t1?21:"auth/weak-password"===t.t1?23:25;break;case 19:return r="Email already registered",t.abrupt("break",26);case 21:return r="Invalid email",t.abrupt("break",26);case 23:return r="Password must be 6+ characters",t.abrupt("break",26);case 25:return t.abrupt("break",26);case 26:e.setState({errorMessage:r});case 27:case"end":return t.stop()}}),t,null,[[4,13]])})));return function(e){return t.apply(this,arguments)}}(),e.addUser=function(){var t=Object(h.a)(u.a.mark((function t(s){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{x.collection("users").doc(s.uid).set({username:e.state.username,high_score:0})}catch(a){}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={username:"",email:"",password:"",signedIn:!1,errorMessage:""},e}return Object(b.a)(s,[{key:"render",value:function(){return this.state.signedIn?Object(O.jsx)(o.a,{to:"/play"}):Object(O.jsxs)("div",{class:"SignUp",children:[Object(O.jsx)("h2",{children:"CREATE AN ACCOUNT"}),Object(O.jsxs)("form",{children:[Object(O.jsx)("input",{type:"text",name:"username",placeholder:"Username",onChange:this.formChangeHandler}),Object(O.jsx)("input",{type:"text",name:"email",placeholder:"Email",onChange:this.formChangeHandler}),Object(O.jsx)("input",{type:"password",name:"password",placeholder:"Password",onChange:this.formChangeHandler}),Object(O.jsx)("p",{class:"errorMessage",children:this.state.errorMessage}),Object(O.jsxs)("div",{children:[Object(O.jsx)("a",{onClick:this.submitFormHandler,children:"SUBMIT"}),Object(O.jsx)("h6",{children:Object(O.jsx)(c.b,{to:"/",children:"CANCEL"})})]})]})]})}}]),s}(n.a.Component),D=function(e){Object(j.a)(s,e);var t=Object(m.a)(s);function s(){var e;return Object(d.a)(this,s),(e=t.call(this)).userSignOut=Object(h.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.signOut();case 3:e.setState({signOut:!0}),t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])}))),e.state={signOut:!1},e}return Object(b.a)(s,[{key:"render",value:function(){return this.state.signOut?Object(O.jsx)(o.a,{to:"/"}):Object(O.jsxs)("div",{className:"Play",children:[Object(O.jsx)(W,{signOut:this.userSignOut}),Object(O.jsx)(P,{dimension:550})]})}}]),s}(n.a.Component),F=function(e){Object(j.a)(s,e);var t=Object(m.a)(s);function s(){var e;return Object(d.a)(this,s),(e=t.call(this)).userSignOut=Object(h.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.signOut();case 3:e.setState({signOut:!0}),t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])}))),e.getTopScores=function(){var t=Object(h.a)(u.a.mark((function t(s){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.leaderboard,t.prev=1,t.next=4,x.collection("users").orderBy("high_score","desc").limit(s).get();case 4:t.sent.forEach((function(e){a.push(e.data())})),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(1);case 10:e.setState({leaderboard:a});case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}(),e.state={signOut:!1,leaderboard:[]},e.getTopScores(5),e}return Object(b.a)(s,[{key:"render",value:function(){if(this.state.signOut)return Object(O.jsx)(o.a,{to:"/"});var e=this.state.leaderboard.map((function(e,t){return Object(O.jsx)(K,{place:t+1,username:e.username,score:e.high_score},t)}));return Object(O.jsxs)("div",{className:"LeaderBoard",children:[Object(O.jsx)(W,{signOut:this.userSignOut}),Object(O.jsx)(K,{place:"place",username:"username",score:"score"},-1),e]})}}]),s}(n.a.Component),K=function(e){return Object(O.jsxs)("div",{className:"LeaderBoardItem",children:[Object(O.jsx)("p",{children:e.place}),Object(O.jsx)("p",{children:e.username}),Object(O.jsx)("p",{children:e.score})]},e.key)},W=function(e){return Object(O.jsxs)("div",{className:"Header",children:[Object(O.jsx)(c.b,{to:"/play",children:"PLAY"}),Object(O.jsx)(c.b,{to:"/leaderboard",children:"LEADERBOARD"}),Object(O.jsx)("a",{onClick:e.signOut,children:"SIGN OUT"})]})};i.a.render(Object(O.jsx)(c.a,{children:Object(O.jsxs)(o.d,{children:[Object(O.jsx)(o.b,{exact:!0,path:"/",component:R}),Object(O.jsx)(o.b,{exact:!0,path:"/login",component:H}),Object(O.jsx)(o.b,{exact:!0,path:"/signup",component:T}),Object(O.jsx)(o.b,{exact:!0,path:"/play",component:D}),Object(O.jsx)(o.b,{exact:!0,path:"/leaderboard",component:F})]})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.23743efb.chunk.js.map